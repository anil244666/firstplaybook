---
- name: Install Python on servers
  hosts: ec2-user
  become: yes

  tasks:
    - name: Update package list
      apt:
        update_cache: yes
      when: ansible_os_family == "Debian"

    - name: Install Python3 (Debian/Ubuntu)
      apt:
        name: python3
        state: present
      when: ansible_os_family == "Debian"

    - name: Install Python3 (RedHat/CentOS)
      yum:
        name: python3
        state: present
      when: ansible_os_family == "RedHat"

    - name: Verify Python installation
      command: python3 --version
      register: python_version
- name: Install Apache (Debian/Ubuntu)
  apt:
    name: apache2
    state: present
  when: ansible_os_family == "Debian"

- name: Install Apache (RedHat/CentOS)
  yum:
    name: httpd
    state: present
  when: ansible_os_family == "RedHat"

- name: Ensure Apache is running
  service:
    name: "{{ 'apache2' if ansible_os_family == 'Debian' else 'httpd' }}"
    state: started
    enabled: yes

- name: Deploy index.html to web root
  copy:
    src: index.html
    dest: "{{ '/var/www/html/index.html' if ansible_os_family == 'Debian' else '/var/www/html/index.html' }}"
    owner: root
    group: root
    mode: '0644'

